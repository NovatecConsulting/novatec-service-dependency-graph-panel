<div class="editor-row">
    <div class="section gf-form-group">

        <div class="section gf-form-group">
            <h5 class="section-heading">Connection Mapping</h5>

            <div class="gf-form-inline">
                <div class="gf-form">
                    <label class="gf-form-label width-18">Source Component Column Prefix</label>
                    <input type="text" class="input-small gf-form-input width-12"
                        placeholder="{{ctrl.panelDefaults.settings.dataMapping.sourceComponentPrefix}}"
                        ng-model="ctrl.panel.settings.dataMapping.sourceComponentPrefix"
                        bs-typeahead="editor.getPrefixCandidates" data-min-length=0 data-items=100
                        ng-change="ctrl.render()" ng-model-onblur />
                </div>
                <div class="gf-form">
                    <label class="gf-form-label width-18">Target Component Column Prefix</label>
                    <input type="text" class="input-small gf-form-input width-12"
                        placeholder="{{ctrl.panelDefaults.settings.dataMapping.targetComponentPrefix}}"
                        ng-model="ctrl.panel.settings.dataMapping.targetComponentPrefix"
                        bs-typeahead="editor.getPrefixCandidates" data-min-length=0 data-items=100
                        ng-change="ctrl.render()" ng-model-onblur />
                </div>
            </div>

            <div class="gf-form-inline">
                <div class="gf-form">
                    <label class="gf-form-label width-8">Type</label>
                    <input type="text" class="input-small gf-form-input width-12"
                        placeholder="{{ctrl.panelDefaults.settings.dataMapping.type}}"
                        ng-model="ctrl.panel.settings.dataMapping.type" bs-typeahead="editor.getColumnNames"
                        data-min-length=0 data-items=100 ng-change="ctrl.render()" ng-model-onblur />
                </div>
                <div class="gf-form">
                    <label class="gf-form-label width-8">External Origin</label>
                    <input type="text" class="input-small gf-form-input width-12"
                        placeholder="{{ctrl.panelDefaults.settings.dataMapping.extOrigin}}"
                        ng-model="ctrl.panel.settings.dataMapping.extOrigin" bs-typeahead="editor.getColumnNames"
                        data-min-length=0 data-items=100 ng-change="ctrl.render()" ng-model-onblur />
                </div>
                <div class="gf-form">
                    <label class="gf-form-label width-8">External Target</label>
                    <input type="text" class="input-small gf-form-input width-12"
                        placeholder="{{ctrl.panelDefaults.settings.dataMapping.extTarget}}"
                        ng-model="ctrl.panel.settings.dataMapping.extTarget" bs-typeahead="editor.getColumnNames"
                        data-min-length=0 data-items=100 ng-change="ctrl.render()" ng-model-onblur />
                </div>
            </div>
        </div>

        <div class="section gf-form-group">
            <h5 class="section-heading">Data Mapping</h5>

            <div class="gf-form-inline">
                <div class="gf-form">
                    <label class="gf-form-label width-16">Response Time Column</label>
                    <input type="text" class="input-small gf-form-input width-12"
                        placeholder="{{ctrl.panelDefaults.settings.dataMapping.responseTimeColumn}}"
                        ng-model="ctrl.panel.settings.dataMapping.responseTimeColumn"
                        bs-typeahead="editor.getColumnNames" data-min-length=0 data-items=100 ng-change="ctrl.render()"
                        ng-model-onblur />
                </div>
                <div class="gf-form">
                    <label class="gf-form-label width-16">Request Rate Column</label>
                    <input type="text" class="input-small gf-form-input width-12"
                        placeholder="{{ctrl.panelDefaults.settings.dataMapping.requestRateColumn}}"
                        ng-model="ctrl.panel.settings.dataMapping.requestRateColumn"
                        bs-typeahead="editor.getColumnNames" data-min-length=0 data-items=100 ng-change="ctrl.render()"
                        ng-model-onblur />
                </div>
                <div class="gf-form">
                    <label class="gf-form-label width-16">Error Rate Column</label>
                    <input type="text" class="input-small gf-form-input width-12"
                        placeholder="{{ctrl.panelDefaults.settings.dataMapping.errorRateColumn}}"
                        ng-model="ctrl.panel.settings.dataMapping.errorRateColumn" bs-typeahead="editor.getColumnNames"
                        data-min-length=0 data-items=100 ng-change="ctrl.render()" ng-model-onblur />
                </div>
            </div>

            <div class="gf-form-inline">
                <div class="gf-form">
                    <label class="gf-form-label width-16">Response Time Column (Outgoing)</label>
                    <input type="text" class="input-small gf-form-input width-12"
                        placeholder="{{ctrl.panelDefaults.settings.dataMapping.responseTimeOutgoingColumn}}"
                        ng-model="ctrl.panel.settings.dataMapping.responseTimeOutgoingColumn"
                        bs-typeahead="editor.getColumnNames" data-min-length=0 data-items=100 ng-change="ctrl.render()"
                        ng-model-onblur />
                </div>
                <div class="gf-form">
                    <label class="gf-form-label width-16">Request Rate Column (Outgoing)</label>
                    <input type="text" class="input-small gf-form-input width-12"
                        placeholder="{{ctrl.panelDefaults.settings.dataMapping.requestRateOutgoingColumn}}"
                        ng-model="ctrl.panel.settings.dataMapping.requestRateOutgoingColumn"
                        bs-typeahead="editor.getColumnNames" data-min-length=0 data-items=100 ng-change="ctrl.render()"
                        ng-model-onblur />
                </div>
                <div class="gf-form">
                    <label class="gf-form-label width-16">Error Rate Column (Outgoing)</label>
                    <input type="text" class="input-small gf-form-input width-12"
                        placeholder="{{ctrl.panelDefaults.settings.dataMapping.errorRateOutgoingColumn}}"
                        ng-model="ctrl.panel.settings.dataMapping.errorRateOutgoingColumn"
                        bs-typeahead="editor.getColumnNames" data-min-length=0 data-items=100 ng-change="ctrl.render()"
                        ng-model-onblur />
                </div>
            </div>

            <div class="gf-form-inline">
                <div class="gf-form">
                    <label class="gf-form-label width-16">Response Time Baseline (Upper)</label>
                    <input type="text" class="input-small gf-form-input width-12"
                        placeholder="{{ctrl.panelDefaults.settings.dataMapping.baselineRtUpper}}"
                        ng-model="ctrl.panel.settings.dataMapping.baselineRtUpper"
                        bs-typeahead="editor.getColumnNames" data-min-length=0 data-items=100 ng-change="ctrl.render()"
                        ng-model-onblur />
                </div>
            </div>
        </div>


        <div class="section gf-form-group">
            <h5 class="section-heading">General Settings</h5>

            <div class="gf-form-inline">
                <gf-form-switch class="gf-form" label="Show Connection Statistics" label-class="width-16"
                    checked="ctrl.panel.settings.showConnectionStats" on-change="ctrl.render()"></gf-form-switch>
            </div>

            <div class="gf-form-inline">
                <label class="gf-form-label width-16">Handle Timings as Sums<info-popover mode="right-normal">If this
                        setting is active, the timings provided by the mapped response time columns are considered as a
                        continually increasing sum of response times. When deactivated, it is considered that the
                        timings provided by columns are the actual average response times.</info-popover></label>
                <gf-form-switch class="gf-form" checked="ctrl.panel.settings.sumTimings" on-change="ctrl.render()">
                </gf-form-switch>
            </div>

            <div class="gf-form-inline">
                <label class="gf-form-label width-16">Filter Empty Data<info-popover mode="right-normal">When enabled,
                        the graph will only show connections and nodes which have a in or out rate higher than zero.
                    </info-popover></label>
                <gf-form-switch class="gf-form" checked="ctrl.panel.settings.filterEmptyConnections"
                    on-change="ctrl.render()"></gf-form-switch>
            </div>

            <div class="gf-form-inline">
                <gf-form-switch class="gf-form" label="Show Debug Information" label-class="width-16"
                    checked="ctrl.panel.settings.showDebugInformation" on-change="ctrl.render()"></gf-form-switch>
            </div>

            <div class="gf-form-inline">
                <gf-form-switch class="gf-form" label="Show Dummy Data" label-class="width-16"
                    checked="ctrl.panel.settings.showDummyData" on-change="ctrl.updateDummyData()"></gf-form-switch>
            </div>
            
            <div class="gf-form-inline">
                <gf-form-switch class="gf-form" label="Show Baselines" label-class="width-16"
                    checked="ctrl.panel.settings.showBaselines" on-change="ctrl.render()"></gf-form-switch>
            </div>
        </div>

        <div class="section gf-form-group">
            <h5 class="section-heading">Appearance</h5>

            <div class="gf-form-inline">
                <label class="gf-form-label width-8">Healthy Color</label>
                <span class="gf-form-label">
                    <spectrum-picker ng-model="ctrl.panel.settings.style.healthyColor" ng-change="ctrl.render()">
                    </spectrum-picker>
                </span>
            </div>

            <div class="gf-form-inline">
                <label class="gf-form-label width-8">Danger Color</label>
                <span class="gf-form-label">
                    <spectrum-picker ng-model="ctrl.panel.settings.style.dangerColor" ng-change="ctrl.render()">
                    </spectrum-picker>
                </span>
            </div>

            <div class="gf-form-inline">
                <label class="gf-form-label width-8">No Data Color</label>
                <span class="gf-form-label">
                    <spectrum-picker ng-model="ctrl.panel.settings.style.unknownColor" ng-change="ctrl.render()">
                    </spectrum-picker>
                </span>
            </div>
        </div>

        <div class="section gf-form-group">
            <h5 class="section-heading">External Service Icon Mapping</h5>

            <div class="gf-form-inline">
                <div class="gf-form">
                    <label class="gf-form-label width-10">Target Type</label>
                    <label class="gf-form-label width-10">Icon</label>
                </div>
            </div>

            <div class="gf-form-inline" ng-repeat="(index, mapping) in ctrl.panel.settings.externalIcons">
                <div class="gf-form">
                    <input type="text" class="input-small gf-form-input width-10"
                        ng-model="ctrl.panel.settings.externalIcons[index].name" ng-change="editor.render()"
                        ng-model-onblur />

                    <select class="input-small gf-form-input width-10"
                        ng-model="ctrl.panel.settings.externalIcons[index].filename" ng-change="editor.render()">
                        <option ng-repeat="variable in editor.getExternalIconOptions()" value="{{variable}}">
                            {{variable}}</option>
                    </select>

                    <a class="gf-form-label tight-form-func" ng-click="editor.removeExternalMapping(index)"><i
                            class="fa fa-trash"></i></a>
                </div>
            </div>

            <button class="btn navbar-button navbar-button--primary" ng-click="editor.addExternalMapping()">Add
                External
                Service Icon Mapping</button>
        </div>

        <div class="section gf-form-group">
            <h5 class="section-heading">Tracing Drilldown</h5>

            <div class="gf-form-inline">
                <label class="gf-form-label width-16">Backend URL<info-popover mode="right-normal">This URL will be used as a drilldown URL for selected service nodes.
                    </info-popover></label>            
                <input type="text" class="input-small gf-form-input width-20" placeholder="http://tracing-backend/"
                    ng-model="ctrl.panel.settings.drillDownLink" bs-typeahead="editor.getTraceBackend" data-min-length=0
                    data-items=100 ng-change="ctrl.render()" ng-model-onblur />
            </div>
        </div>

    </div>